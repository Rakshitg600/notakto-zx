10 DIM b(3,9)
20 DIM s(3)
30 LET p=1
40 FOR i=1 TO 3
50 FOR j=1 TO 9
60 LET b(i,j)=0
70 NEXT j
80 LET s(i)=1
90 NEXT i
100 REM -- MAIN LOOP --
110 CLS
120 PRINT "BOARD STATUS:"
130 FOR i=1 TO 3
140 IF s(i)=1 THEN PRINT "BOARD ";i;" LIVE"
150 IF s(i)=0 THEN PRINT "BOARD ";i;" DEAD"
160 NEXT i
170 PRINT
180 PRINT "PLAYER ";p;" TURN"
190 INPUT "BOARD (1-3):";bn
200 IF bn<1 THEN PRINT "INVALID": PAUSE 50: GO TO 110
210 IF bn>3 THEN PRINT "INVALID": PAUSE 50: GO TO 110
220 IF s(bn)=0 THEN PRINT "BOARD DEAD": PAUSE 50: GO TO 110
230 CLS
240 FOR r=0 TO 2
250 FOR c=1 TO 3
260 LET idx=r*3+c
270 IF b(bn,idx)=1 THEN PRINT "X ";
280 IF b(bn,idx)=0 THEN PRINT ". ";
290 NEXT c
300 PRINT
310 NEXT r
340 PRINT
350 INPUT "CELL (1-9):";c
360 IF c<1 OR c>9 THEN PRINT "INVALID": PAUSE 50: GO TO 110
370 IF b(bn,c)=1 THEN PRINT "TAKEN": PAUSE 50: GO TO 110
380 LET b(bn,c)=1
390 GOSUB 1000
400 IF d=1 THEN GOSUB 2000
410 LET alive=0
420 FOR i=1 TO 3
430 IF s(i)=1 THEN LET alive=alive+1
440 NEXT i
450 IF alive=0 THEN PRINT "PLAYER ";p;" LOSES!": STOP
460 LET p=3-p
470 GO TO 110

1000 REM -- CHECK FOR 3-IN-A-ROW ON CURRENT BOARD --
1010 LET d=0
1020 FOR r=0 TO 2
1030 LET base=r*3
1040 IF b(bn,base+1)=1 THEN IF b(bn,base+2)=1 THEN IF b(bn,base+3)=1 THEN LET d=1: RETURN
1050 NEXT r
1060 FOR c=1 TO 3
1070 IF b(bn,c)=1 THEN IF b(bn,c+3)=1 THEN IF b(bn,c+6)=1 THEN LET d=1: RETURN
1080 NEXT c
1090 IF b(bn,1)=1 AND b(bn,5)=1 AND b(bn,9)=1 THEN LET d=1: RETURN
1100 IF b(bn,3)=1 AND b(bn,5)=1 AND b(bn,7)=1 THEN LET d=1: RETURN
1110 RETURN

2000 REM -- KILL BOARD --
2010 LET s(bn)=0
2020 PRINT "BOARD ";bn;" DIES"
2030 PAUSE 100
2040 RETURN
